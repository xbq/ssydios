<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>运单查询</title>
    <link rel="stylesheet" type="text/css" href="../../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/style.css"/>
    <link rel="stylesheet" href="../../css/weui.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../../css/scCss.css">
    <link rel="stylesheet" type="text/css" href="../../css/glyindex.css">
    <script type="text/javascript" src="../../script/api.js"></script>
    <script type="text/javascript" src="../../script/common.js"></script>
    <script type="text/javascript" src="../../script/jquery.min.js"></script>
    <script type="text/javascript" src="../../script/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../script/jweixin-1.0.0.js"></script>
    <script src="../../script/weui.min.js"></script>
      <script type="text/javascript" src="../../script/gly.js"></script>
          <script src="../../script/echarts.simple.min.js"></script>
    <script src="../../script/week.js"></script>
      <script src="../../script/order.js"></script>
  <style>
    a{ display:inline;}
  </style>
</head>
<body>


<style>
  #Memobox_c{ top:5%; padding:10px; }
  #Memobox_c h4{ padding:5px 0}
  #Memobox_c textarea{ width:96%}
  #Memobox_c .set-style { margin:5px 0; font-size:16px;}
  #Memobox_c p.error { font-size:12px;}
  #Memobox_c  .modal-footer{ background:none;padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
  #Memobox_c button{ padding:2px 10px; margin-top:5px}
  #Memobox_c .modal-header{ background: linear-gradient(to right, #17baff, #178aff); color: #fff; padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
  #Memobox_c .modal-body{ font-size: 16px;}
  #Memobox_c .btcolor{ color: #178aff; border: 0; font-size: 16px;}
  </style>
      <div class="modal fade Memobox" id="Memobox_c" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal"
                  aria-hidden="true">×
              </button>
              <h4 class="modal-title" id="myModalLabel">
                选择采砂船
              </h4>
            </div>
            <div class="modal-body" id="csqid">

            </div>

            <div class="modal-footer">
           <a class="btn btn-default btcolor" data-dismiss="modal">取消</a>
       </div>

          </div>
        </div>
      </div>

<style>
  #Memobox{ top:5%; padding:10px; }
  #Memobox h4{ padding:5px 0}
  #Memobox textarea{ width:96%}
  #Memobox .set-style { margin:5px 0; font-size:16px;}
  #Memobox p.error { font-size:12px;}
  #Memobox  .modal-footer{ background:none;padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
  #Memobox button{ padding:2px 10px; margin-top:5px}
  #Memobox .modal-header{ background: linear-gradient(to right, #17baff, #178aff); color: #fff; padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
  #Memobox .modal-body{ font-size: 16px;}
  #Memobox .btcolor{ color: #178aff; border: 0; font-size: 16px;}
  </style>
      <div class="modal fade Memobox" id="Memobox" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal"
                  aria-hidden="true">×
              </button>
              <h4 class="modal-title" id="myModalLabel">
                选择采区
              </h4>
            </div>
            <div class="modal-body" id="caiquid">

            </div>

            <div class="modal-footer">
           <a class="btn btn-default btcolor" data-dismiss="modal">取消</a>
       </div>

          </div>
        </div>
      </div>

<!-- 沙场 -->
<style>
#Memobox_s{ top:5%; padding:10px; }
#Memobox_s h4{ padding:5px 0}
#Memobox_s textarea{ width:96%}
#Memobox_s .set-style { margin:5px 0; font-size:16px;}
#Memobox_s p.error { font-size:12px;}
#Memobox_s  .modal-footer{ background:none;padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
#Memobox_s button{ padding:2px 10px; margin-top:5px}
#Memobox_s .modal-header{ background: linear-gradient(to right, #17baff, #178aff); color: #fff;padding-top: 10px; padding-bottom: 10px;padding-top: 10px; padding-bottom: 10px;}
#Memobox_s .modal-body{ font-size: 16px;}
#Memobox_s .btcolor{ color: #178aff; border: 0; font-size: 16px;}
</style>
  <div class="modal fade Memobox" id="Memobox_s" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal"
              aria-hidden="true">×
          </button>
          <h4 class="modal-title" id="myModalLabel">
            选择砂场
          </h4>
        </div>
        <div class="modal-body" id="shachangid">

        </div>

        <div class="modal-footer">
       <a class="btn btn-default btcolor" data-dismiss="modal">取消</a>
   </div>

      </div>
    </div>
  </div>

<div class="s-zd" id="s-zd"></div>
  <div id="wrap" class="flex-wrap flex-vertical">
    <div class="container grad" id="yd">
      <div class="i20"></div>
      <div class="row">

        <div class=" font2" align="center"> 运单统计 </div>

      </div>
      <div style="clear: both"></div>
    </div>







<div class="s-ydtjaa" style=" min-height: 124px; position: relative; zoom:1; ">
<div class="s-clear"></div>
   <div class="s-ydtj1"><span><img src="../../image/g6.png" ></span>选择时段</div>
   <div class="s-ydtj2">
   <span id="sbybd">本周

   </span>
      <ul id="sby">
     <li><a  onClick="sectime(1,'本周')">本周</a></li>
     <li><a  onClick="sectime(2,'本月')">本月</a></li>
     <li><a  onClick="sectime(3,'本季')">本季</a></li>
     <li><a  onClick="sectime(4,'本年')">本年</a></li>
     <li><a  onClick="sectime(5,'自定义')">自定义</a></li>
   </ul>
   </div>
   <div class="s-ydtj3">
       <ul>
          <li> <span id="ftime" class=""></span>
          </li>
          <li style="width:10px; text-align:center">-</li>
          <li><span id="totime" class=""></span></li>
       </ul>
   </div>

<div class="s-csxbox">
<div class="s-csx"><span><img src="../../image/g7.png" ></span></div>
   <div class="s-con">
       <ul>
          <li><a  href="#" data-toggle="modal" data-target="#Memobox" ><span id="caiquid_sel">采区</span></a></li>
          <li><a  href="#" data-toggle="modal" data-target="#Memobox_s" ><span id="shachang_sel">砂场</span></a></li>
          <li><a  href="#" data-toggle="modal" data-target="#Memobox_c" ><span id="csq_sel">采砂船</span></a></li>
          <li><input type="text" id="boatName" name="boatName" class="form-control" placeholder="运砂船" /></li>
       </ul>
   </div>
   <input type="hidden" id="fromDistrict"  /><input type="hidden" id="toDistrict" /><input type="hidden" id="sandboatId" />
</div>


<div class="s-but">

<div class="s-but-a">
<button type="button" class="btn btn-default" onclick="subret()">重置</button>

</div>
<div class="s-but-b">
<button type="button" class="btn btn-primary" onclick="subgetlist()" style="background:#1791ff; border:1px solid #1791ff">查询</button>
</div>

</div>


</div>


<script>

function subret()
{
  if($api.getStorage('glyjryda')==0)
  {
  sectime(1,'本周');
  }

  $("#caiquid_sel").html("采区");
  $("#shachang_sel").html("砂场");
  $("#csq_sel").html("采砂船");
  $("#fromDistrict").val("");
  $("#toDistrict").val("");
  $("#sandboatId").val("");
  $("#boatName").val("");
}

function subgetlist(){
  $api.setStorage('glyjryda',0);
     getlistapp()
}

function  getlistapp()
{
 var fromDistrict_el=document.getElementById("fromDistrict");
 var toDistrict_el=document.getElementById("toDistrict");
 var sandboatId_el=document.getElementById("sandboatId");
 var boatName_el=document.getElementById("boatName");
  var ftime_el=document.getElementById("ftime");
   var totime_el=document.getElementById("totime");
var  fromDistrict= $api.val(fromDistrict_el);
var  toDistrict=  $api.val(toDistrict_el);
var  sandboatId=  $api.val(sandboatId_el);
var  boatName=  $api.val(boatName_el);
var  begintime=  $api.html(ftime_el);
var  endtime=  $api.html(totime_el);
  api.ajax({

    url: functionURL + 'wayBillScreen/getListForApp.json',
      method: 'get',

      headers:
      {

        login_token:$api.getStorage('loginToken')
      },

      data: {
          values: {
             fromDistrict:fromDistrict,
             toDistrict:toDistrict,
             sandboatId:sandboatId,
             boatName:boatName,
             begintime:begintime,
              endtime:endtime,

          },
          files: {
              file: 'fs://a.gif'
          }
      }
  }, function(ret, err) {
      if (ret) {

     var slista_el=document.getElementById("slista");
       if( ret['data'].length>0)
           {
             var html = '';


             for (i = 0; i < ret['data'].length; i++) {
               var item = ret['data'][i];

              html+=' <div class="s-item" onclick="openorderinfo('+item['uid']+')">';
              html+='<div class="s-item-t">';
              html+='<ul>';
              html+='<li><span>发</span>'+item['fromName']+'</li>';
              html+='<li><span>收</span>'+item['toName']+'</li>';
              html+='<li><p>'+item['starttime']+'</p></li>';
              html+='</ul>';
              html+='</div>';
              html+='<div class="s-item-c">';
              html+='<ul>';
              html+='<li>采砂船:'+item['sandboatName']+'</li>';
              html+='<li>运砂船:'+item['boatName']+'</li>';
              html+='<li>'+item['realWeight']+'吨</li>';
              html+='</ul>';
              html+='</div>';
              html+='</div>';



             }

             $api.html(slista_el,html);

           }
           else {
              $api.html(slista_el,"暂无信息!");
           }


      }
      else {
        getlistapp();
      }
  });

}

function getlistappall(ftimenum,totimenum)
{

  var fromDistrict_el=document.getElementById("fromDistrict");
  var toDistrict_el=document.getElementById("toDistrict");
  var sandboatId_el=document.getElementById("sandboatId");
  var boatName_el=document.getElementById("boatName");

 var  fromDistrict= $api.val(fromDistrict_el);
 var  toDistrict=  $api.val(toDistrict_el);
 var  sandboatId=  $api.val(sandboatId_el);
 var  boatName=  $api.val(boatName_el);
 var  begintime=  ftimenum;
 var  endtime=  totimenum;
   api.ajax({

     url: functionURL + 'wayBillScreen/getListForApp.json',
       method: 'get',

       headers:
       {

         login_token:$api.getStorage('loginToken')
       },

       data: {
           values: {
              fromDistrict:fromDistrict,
              toDistrict:toDistrict,
              sandboatId:sandboatId,
              boatName:boatName,
              begintime:begintime,
               endtime:endtime,

           },
           files: {
               file: 'fs://a.gif'
           }
       }
   }, function(ret, err) {
       if (ret) {

      var slista_el=document.getElementById("slista");
        if( ret['data'].length>0)
            {
              var html = '';


              for (i = 0; i < ret['data'].length; i++) {
                var item = ret['data'][i];

               html+=' <div class="s-item" onclick="openorderinfo('+item['uid']+')">';
               html+='<div class="s-item-t">';
               html+='<ul>';
               html+='<li><span>发</span>'+item['fromName']+'</li>';
               html+='<li><span>收</span>'+item['toName']+'</li>';
               html+='<li><p>'+item['starttime']+'</p></li>';
               html+='</ul>';
               html+='</div>';
               html+='<div class="s-item-c">';
               html+='<ul>';
               html+='<li>采砂船:'+item['sandboatName']+'</li>';
               html+='<li>运砂船:'+item['boatName']+'</li>';
               html+='<li>'+item['realWeight']+'吨</li>';
               html+='</ul>';
               html+='</div>';
               html+='</div>';



              }

              $api.html(slista_el,html);

            }
            else {
               $api.html(slista_el,"暂无信息!");
            }


       }
       else {
         getlistappall(ftimenum,totimenum);
       }
   });

}

function caiquid(name,uid)
{

 var caiquid_sel_el=document.getElementById("caiquid_sel");
 var from_district_el=document.getElementById("fromDistrict");


 $api.html(caiquid_sel_el,name);
  $api.val(from_district_el,uid);
 $('#Memobox').modal('hide');




}
function caiqu()
{
  api.ajax({

    url: functionURL + 'districtScreen/getAll.json',
      method: 'get',

      headers:
      {

        login_token:$api.getStorage('loginToken')
      },

      data: {
          values: {

          },
          files: {
              file: 'fs://a.gif'
          }
      }
  }, function(ret, err) {
      if (ret) {


       if( ret['data'].length>0)
           {
             var html = '';
             var caiquid_el=document.getElementById("caiquid");

             for (i = 0; i < ret['data'].length; i++) {
               var item = ret['data'][i];

                  html+='<div class="form-group" style=" width:100%" onclick=caiquid("'+item['name']+'",'+item['uid']+')>';
                  html+='<span >'+item['name']+'</span>';
                  html+='</div>';

             }

             $api.html(caiquid_el,html);

           }


      }
      else {
        caiqu();
      }
  });

}

function shachangid(name,uid)
{

  var to_district_el=document.getElementById("toDistrict");

 var caiquid_sel_el=document.getElementById("shachang_sel");
 $api.html(caiquid_sel_el,name);
  $api.val(to_district_el,uid);
 $('#Memobox_s').modal('hide');

}

function shachang()
{
  api.ajax({

    url: functionURL + 'sandPlantScreen/getAll.json',
      method: 'get',
      headers:
      {

        login_token:$api.getStorage('loginToken')
      },
      data: {
          values: {

          },
          files: {
              file: 'fs://a.gif'
          }
      }
  }, function(ret, err) {
      if (ret) {


       if( ret['data'].length>0)
           {
             var html = '';
             var shachangid_el=document.getElementById("shachangid");

             for (i = 0; i < ret['data'].length; i++) {
               var item = ret['data'][i];

                  html+='<div class="form-group" style=" width:100%" onclick=shachangid("'+item['name']+'",'+item['uid']+')>';
                  html+='<span >'+item['name']+'</span>';
                  html+='</div>';

             }

             $api.html(shachangid_el,html);

           }


      }
      else {
        shachang();
      }
  });

}


function csqid(name,uid)
{

  var sandboatId_el=document.getElementById("sandboatId");

 var csq_sel_el=document.getElementById("csq_sel");
 $api.html(csq_sel_el,name);
  $api.val(sandboatId_el,uid);
 $('#Memobox_c').modal('hide');

}

function csq()
{
  api.ajax({

    url: functionURL + 'sandBoatScreen/getList.json',
      method: 'get',
      headers:
      {

        login_token:$api.getStorage('loginToken')
      },
      data: {
          values: {

          },
          files: {
              file: 'fs://a.gif'
          }
      }
  }, function(ret, err) {
      if (ret) {


       if( ret['data'].length>0)
           {
             var html = '';
             var csqid_el=document.getElementById("csqid");

             for (i = 0; i < ret['data'].length; i++) {
               var item = ret['data'][i];

                  html+='<div class="form-group" style=" width:100%" onclick=csqid("'+item['name']+'",'+item['uid']+')>';
                  html+='<span >'+item['name']+'</span>';
                  html+='</div>';

             }

             $api.html(csqid_el,html);

           }


      }
      else {
        csq();
      }
  });

}


function sectime(num,stra)
{
	var ftimenum,totimenum;

	totimenum=getday();
	switch(num)
	{
		case 1:
	ftimenum=getmonday();
		  break;
		case 2:
	ftimenum=getCurrentMonth();
    break;
		case 3:
	ftimenum=getFirstDayOfSeason();
    break;
		case 4:
	ftimenum=getFirstDayOfYear();
		  break;
      	case 5:
          break;
		default:

	}

$("#ftime").html(ftimenum);
$("#totime").html(totimenum);
$("#sby").hide();
$("#sbybd").html(stra);

}

</script>

<div class="s-clear"></div>

 <div id="main" class="flex-con"  style="position:relative; z-index:3">

<div id="slista">
<!--
    <div class="s-item">
       <div class="s-item-t">
         <ul>
           <li><span>发</span>中支采区1111111</li>
           <li><span>收</span>新钱港砂厂</li>
           <li><p>2015-02-16 18:16:20</p></li>
         </ul>
       </div>
       <div class="s-item-c">
          <ul>
            <li>采砂船：0190</li>
            <li>运砂船：0190</li>
            <li>1024吨</li>
          </ul>

       </div>
    </div> -->











</div>


  </div>
</div>
    <link rel="stylesheet" type="text/css" href="../../css/waves.css">
      <script type="text/javascript" src="../../script/waves.min.js"></script>

</body>
</html>


<script>

$(document).on('ready', function () {

     Waves.init();


	     $("#sbybd").click(function(){
     $("#sby").show();
});

     $("#main").click(function(){
     $("#sby").hide();

});


});

$('#totime').on('click', function () {

    weui.datePicker({
        start: 1990,
        end: new Date().getFullYear(),
        defaultValue:[new Date().getFullYear(),(new Date().getMonth())+1,new Date().getDate()],
        onChange: function (result) {
            console.log(result);
        },
        onConfirm: function (result) {
              str=JSON.stringify(result);
      				str=str.replace("[","");
      				str=str.replace("]","");

      				str=str.split(",");
              var sa=str[0]+'-'+str[1]+'-'+str[2];

              	$('#totime').html(sa);

$("#sbybd").html("自定义");
        }
    });
});

$('#ftime').on('click', function () {

    weui.datePicker({
        start: 1990,
        end: new Date().getFullYear(),
        defaultValue:[new Date().getFullYear(),(new Date().getMonth())+1,new Date().getDate()],
        onChange: function (result) {
            console.log(result);
        },
        onConfirm: function (result) {
              str=JSON.stringify(result);
      				str=str.replace("[","");
      				str=str.replace("]","");

      				str=str.split(",");
              var sa=str[0]+'-'+str[1]+'-'+str[2];

              	$('#ftime').html(sa);

$("#sbybd").html("自定义");
        }
    });
});


function sliding() {

  // GoToRefresh();
  api.closeWin({
    name:'glyydcx',
    animation: {type:'none'}
  });

   }

   apiready = function () {

var ftimenum,totimenum;
totimenum=getday();
ftimenum=getmonday();
if($api.getStorage('glyjryda')==1)
{
totimenum=getday();
ftimenum=getday();
$("#sbybd").html("自定义");
}

$("#ftime").html(ftimenum);
$("#totime").html(totimenum);
getlistappall(ftimenum,totimenum);
csq();
caiqu();
shachang();

$api.fixTabBar($api.byId('footer'));


   }


</script>
